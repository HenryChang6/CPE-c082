#include<iostream>
#include<string>
using namespace std;


int main(){
    int border_x,border_y;   cin>>border_x>>border_y;
    int init_x = 0 , init_y = 0 , dir;   
    char init_dir , outpdir; 
    string order;
    while(cin>>init_x>>init_y>>init_dir){
        bool lost = false;
        switch(init_dir){
            case 'N': dir = 0; break;
            case 'E': dir = 1; break;
            case 'S': dir = 2; break;
            case 'W': dir = 3; break;
        }
        cin>>order;
        for(int i=0;i<order.length();i++){       
        if(order[i] != 'F' && !lost){
            if(order[i] == 'R') dir = (dir++)%4;
            if(order[i] == 'L') dir = (dir++)%4;
        }
        else{
        if(dir == 0 && !lost){
            if(++init_y > border_y){
                lost = true;
                init_y--;
                break;
            }
            else init_y++;
        }
        else if(dir == 1 && !lost){
            if(++init_x > border_x){
                lost = true;
                init_x--;
                break;
            }
            else init_x++;
        }
        else if(dir == 2 && !lost){
            if(--init_y < border_y){
                lost = true;
                init_y++;
                break;
            }
            else init_y--;
        }
        else if(dir == 3 && !lost){
            if(--init_x < border_x){
                lost = true;
                init_x++;
                break;
            }
            else init_x--;
        }
        
    }
}  
        if(dir == 0) outpdir = 'N';
        if(dir == 1) outpdir = 'E';
        if(dir == 2) outpdir = 'S';
        if(dir == 3) outpdir = 'W';

        if(lost) cout<<init_x<<" "<<init_y<<" "<<outpdir<<" "<<"LOST"<<endl;
        else cout<<init_x<<" "<<init_y<<" "<<outpdir<<endl;
    }
    return 0;
}
